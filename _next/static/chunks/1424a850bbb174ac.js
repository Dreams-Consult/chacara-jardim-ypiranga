(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18333,e=>{"use strict";var r=e.i(71645);function t(e,a=5e3){(0,r.useEffect)(()=>{let r=setInterval(()=>{e()},a);return()=>clearInterval(r)},[e,a])}e.s(["useRealtimeUpdates",()=>t])},31886,e=>{"use strict";var r=e.i(43476),t=e.i(73297),a=e.i(71645);function s({imageUrl:e,lots:s,onLotClick:l,isEditMode:o=!1,onAreaDrawn:n,selectedLotId:i,drawingMode:d="polygon",previewArea:c=null}){let{canvasRef:u,imageRef:m,containerRef:h,hoveredLot:x,drawingPoints:g,scale:p,handleCanvasClick:f,handleCanvasMouseMove:b,handleMouseDown:v,handleMouseUp:y,handleContextMenu:j,handleTouchStart:w,handleTouchMove:N,handleTouchEnd:P,handleZoomIn:k,handleZoomOut:C,handleResetZoom:S,handleFinishDrawing:E,handleCancelDrawing:L}=function({imageUrl:e,lots:r,onLotClick:s,isEditMode:l=!1,onAreaDrawn:o,selectedLotId:n,drawingMode:i="polygon",previewArea:d=null}){let c=(0,a.useRef)(null),u=(0,a.useRef)(null),m=(0,a.useRef)(null),[h,x]=(0,a.useState)([]),[g,p]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[v,y]=(0,a.useState)(1),[j,w]=(0,a.useState)({x:0,y:0}),[N,P]=(0,a.useState)(!1),[k,C]=(0,a.useState)({x:0,y:0}),[S,E]=(0,a.useState)(null),[L,A]=(0,a.useState)(1),[M,R]=(0,a.useState)({x:0,y:0}),[$,I]=(0,a.useState)(null),[D,F]=(0,a.useState)(!1),[V,B]=(0,a.useState)(null),[T,z]=(0,a.useState)(null),W=(0,a.useCallback)(()=>{let e=c.current,a=u.current;if(!e||!a||!f)return;let s=e.getContext("2d");if(s){if(s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.clearRect(0,0,e.width,e.height),s.save(),s.translate(j.x,j.y),s.scale(v,v),s.drawImage(a,0,0),r.forEach(e=>{((e,r,a,s)=>{if(r.area.points.length<3)return;e.beginPath(),e.moveTo(r.area.points[0].x,r.area.points[0].y),r.area.points.forEach(r=>{e.lineTo(r.x,r.y)}),e.closePath();let l="rgba(34, 197, 94, 0.3)",o="#22c55e";r.status===t.LotStatus.RESERVED?(l="rgba(251, 191, 36, 0.3)",o="#fbbf24"):r.status===t.LotStatus.SOLD&&(l="rgba(239, 68, 68, 0.3)",o="#ef4444"),a&&(l=l.replace("0.3","0.5"),o="#000"),s&&(l="rgba(59, 130, 246, 0.5)",o="#3b82f6"),e.fillStyle=l,e.fill(),e.strokeStyle=o,e.lineWidth=a||s?3:2,e.stroke()})(s,e,e.id===g?.id,e.id===n)}),l&&"polygon"===i&&h.length>0&&(s.beginPath(),s.moveTo(h[0].x,h[0].y),h.forEach(e=>{s.lineTo(e.x,e.y)}),s.strokeStyle="#3b82f6",s.lineWidth=2/v,s.stroke(),h.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,5/v,0,2*Math.PI),s.fillStyle="#3b82f6",s.fill()})),l&&"rectangle"===i&&D&&V&&T){let e=T.x-V.x,r=T.y-V.y;s.strokeStyle="#3b82f6",s.fillStyle="rgba(59, 130, 246, 0.2)",s.lineWidth=2/v,s.strokeRect(V.x,V.y,e,r),s.fillRect(V.x,V.y,e,r)}l&&d&&d.points.length>=3&&(s.beginPath(),s.moveTo(d.points[0].x,d.points[0].y),d.points.forEach(e=>{s.lineTo(e.x,e.y)}),s.closePath(),s.fillStyle="rgba(34, 197, 94, 0.3)",s.fill(),s.strokeStyle="#22c55e",s.lineWidth=3/v,s.stroke(),d.points.forEach(e=>{s.beginPath(),s.arc(e.x,e.y,6/v,0,2*Math.PI),s.fillStyle="#22c55e",s.fill(),s.strokeStyle="#fff",s.lineWidth=2/v,s.stroke()})),s.restore()}},[f,r,h,g,n,l,v,j,i,D,V,T,d]);(0,a.useEffect)(()=>{let r=c.current,t=u.current;if(!r||!t||!e||""===e.trim())return;let a=()=>{r.width=t.naturalWidth,r.height=t.naturalHeight,b(!0)},s=()=>{console.error("Erro ao carregar imagem do mapa")};return t.addEventListener("load",a),t.addEventListener("error",s),t.src=e,()=>{t.removeEventListener("load",a),t.removeEventListener("error",s)}},[e]),(0,a.useEffect)(()=>{W()},[W]);let q=(e,r,t)=>{let a=!1;for(let s=0,l=t.length-1;s<t.length;l=s++){let o=t[s].x,n=t[s].y,i=t[l].x,d=t[l].y;n>r!=d>r&&e<(i-o)*(r-n)/(d-n)+o&&(a=!a)}return a},O=e=>{let r=c.current;if(!r)return{x:0,y:0};let t=r.getBoundingClientRect(),a=e.clientX-t.left,s=e.clientY-t.top,l=r.width/t.width,o=r.height/t.height;return{x:(a*l-j.x)/v,y:(s*o-j.y)/v}},U=(0,a.useCallback)(e=>{e.preventDefault();let r=c.current;if(!r)return;let t=r.getBoundingClientRect(),a=e.clientX-t.left,s=e.clientY-t.top,l=r.width/t.width,o=r.height/t.height,n=a*l,i=s*o,d=(n-j.x)/v,u=(i-j.y)/v,m=Math.max(.5,Math.min(v+(e.deltaY>0?-.1:.1),5));y(m),w({x:n-d*m,y:i-u*m})},[v,j]),Y=(e,r)=>{let t=e.clientX-r.clientX,a=e.clientY-r.clientY;return Math.sqrt(t*t+a*a)},X=(e,r)=>({x:(e.clientX+r.clientX)/2,y:(e.clientY+r.clientY)/2});return(0,a.useEffect)(()=>{let e=c.current;if(e)return e.addEventListener("wheel",U,{passive:!1}),()=>{e.removeEventListener("wheel",U)}},[U]),{canvasRef:c,imageRef:u,containerRef:m,hoveredLot:g,drawingPoints:h,scale:v,handleCanvasClick:e=>{if(N||D)return;let{x:t,y:a}=O(e);if(l&&"polygon"===i)x([...h,{x:t,y:a}]);else if(!l){let e=r.find(e=>q(t,a,e.area.points));e&&s&&s(e)}},handleCanvasMouseMove:e=>{let t=c.current;if(!t)return;if(N){let r=t.getBoundingClientRect(),a=t.width/r.width,s=t.height/r.height,l=(e.clientX-k.x)*a,o=(e.clientY-k.y)*s;w(e=>({x:e.x+l,y:e.y+o})),C({x:e.clientX,y:e.clientY});return}if(D&&V){let{x:r,y:t}=O(e);z({x:r,y:t});return}if(l)return;let{x:a,y:s}=O(e),o=r.find(e=>q(a,s,e.area.points));p(o||null),o?t.style.cursor="pointer":t.style.cursor="default"},handleMouseDown:e=>{if(2===e.button)e.preventDefault(),P(!0),C({x:e.clientX,y:e.clientY}),c.current&&(c.current.style.cursor="grabbing");else if(0===e.button&&l&&"rectangle"===i){let{x:r,y:t}=O(e);F(!0),B({x:r,y:t}),z({x:r,y:t})}},handleMouseUp:e=>{if(P(!1),c.current&&(c.current.style.cursor="default"),D&&V&&o){let r=O(e),t=Math.min(V.x,r.x),a=Math.max(V.x,r.x),s=Math.min(V.y,r.y),l=Math.max(V.y,r.y),n=l-s;if(a-t>10&&n>10){let e=[{x:t,y:s},{x:a,y:s},{x:a,y:l},{x:t,y:l}];console.log("ðŸ“ RetÃ¢ngulo criado:",{start:V,end:r,points:e}),o({points:e})}F(!1),B(null),z(null)}},handleContextMenu:e=>{e.preventDefault()},handleTouchStart:e=>{if(2===e.touches.length){let r=Y(e.touches[0],e.touches[1]),t=X(e.touches[0],e.touches[1]),a=c.current;if(!a)return;let s=a.getBoundingClientRect(),l=t.x-s.left,o=t.y-s.top;E(r),A(v),R({x:j.x,y:j.y}),I({x:l,y:o})}else 1!==e.touches.length||l||(P(!0),C({x:e.touches[0].clientX-j.x,y:e.touches[0].clientY-j.y}))},handleTouchMove:e=>{if(2===e.touches.length&&null!==S&&$){e.preventDefault();let r=c.current;if(!r)return;let t=r.getBoundingClientRect(),a=X(e.touches[0],e.touches[1]),s=a.x-t.left,l=a.y-t.top,o=Math.max(.5,Math.min(Y(e.touches[0],e.touches[1])/S*L,5)),n=r.width/t.width,i=r.height/t.height,d=$.x*n,u=$.y*i,m=(d-M.x)/L,h=(u-M.y)/L;y(o),w({x:s*n-m*o,y:l*i-h*o})}else 1===e.touches.length&&N&&!l&&(e.preventDefault(),w({x:e.touches[0].clientX-k.x,y:e.touches[0].clientY-k.y}))},handleTouchEnd:()=>{E(null),I(null),P(!1)},handleZoomIn:()=>{y(e=>Math.min(e+.2,5))},handleZoomOut:()=>{y(e=>Math.max(e-.2,.5))},handleResetZoom:()=>{y(1),w({x:0,y:0})},handleFinishDrawing:()=>{"polygon"===i&&h.length>=3&&o&&(o({points:h}),x([]))},handleCancelDrawing:()=>{x([]),F(!1),B(null),z(null)}}}({imageUrl:e,lots:s,onLotClick:l,isEditMode:o,onAreaDrawn:n,selectedLotId:i,drawingMode:d,previewArea:c});return(0,r.jsxs)("div",{ref:h,className:"relative",children:[e&&""!==e.trim()?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{ref:m,src:e,alt:"Map",className:"hidden"}),(0,r.jsx)("canvas",{ref:u,onClick:f,onMouseMove:b,onMouseDown:v,onMouseUp:y,onMouseLeave:y,onContextMenu:j,onTouchStart:w,onTouchMove:N,onTouchEnd:P,className:"border border-gray-300 rounded-lg shadow-lg cursor-crosshair max-w-full"})]}):(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center bg-gray-50",children:[(0,r.jsx)("svg",{className:"w-24 h-24 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Nenhuma imagem do mapa carregada"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Adicione uma imagem ao mapa para comeÃ§ar a desenhar os lotes"})]}),(0,r.jsxs)("div",{className:"absolute top-4 right-4 flex flex-col gap-2",children:[(0,r.jsx)("button",{onClick:k,className:"bg-white hover:bg-gray-50 text-gray-800 font-bold py-2 px-3 rounded-lg shadow-lg border border-gray-200 transition-all hover:shadow-xl cursor-pointer",title:"Zoom In",children:"+"}),(0,r.jsx)("button",{onClick:C,className:"bg-white hover:bg-gray-50 text-gray-800 font-bold py-2 px-3 rounded-lg shadow-lg border border-gray-200 transition-all hover:shadow-xl cursor-pointer",title:"Zoom Out",children:"-"}),(0,r.jsx)("button",{onClick:S,className:"bg-white hover:bg-gray-50 text-gray-800 font-medium py-2 px-3 rounded-lg shadow-lg border border-gray-200 transition-all hover:shadow-xl text-xs cursor-pointer",title:"Reset Zoom",children:"Reset"}),(0,r.jsxs)("div",{className:"bg-white px-3 py-1 rounded-lg shadow-lg border border-gray-200 text-xs text-gray-700 text-center",children:[Math.round(100*p),"%"]})]}),o&&"polygon"===d&&g.length>0&&(0,r.jsxs)("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[(0,r.jsxs)("button",{onClick:E,className:"px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 shadow-lg transition-all hover:shadow-xl disabled:bg-gray-300 disabled:cursor-not-allowed disabled:shadow-none cursor-pointer",disabled:g.length<3,children:["Finalizar Ãrea (",g.length," pontos)"]}),(0,r.jsx)("button",{onClick:L,className:"px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 shadow-lg transition-all hover:shadow-xl cursor-pointer",children:"Cancelar"})]}),o&&"rectangle"===d&&!c&&(0,r.jsx)("div",{className:"absolute bottom-4 left-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg",children:(0,r.jsx)("p",{className:"font-medium",children:"ðŸ”² Modo RetÃ¢ngulo: Clique e arraste para desenhar"})}),o&&c&&c.points.length>=3&&(0,r.jsx)("div",{className:"absolute bottom-4 left-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg",children:(0,r.jsx)("p",{className:"font-medium",children:"âœ… Ãrea selecionada - Complete as informaÃ§Ãµes do lote"})}),x&&!o&&(0,r.jsxs)("div",{className:"absolute top-4 left-4 bg-white p-4 rounded-lg shadow-xl border border-gray-200",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg text-gray-900 mb-2",children:["Lote ",x.lotNumber]}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 mb-1",children:[(0,r.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,r.jsx)("span",{className:x.status===t.LotStatus.AVAILABLE?"font-semibold text-green-700":x.status===t.LotStatus.RESERVED?"font-semibold text-amber-700":"font-semibold text-red-700",children:x.status===t.LotStatus.AVAILABLE?"DisponÃ­vel":x.status===t.LotStatus.RESERVED?"Reservado":"Vendido"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-700 mb-1",children:[(0,r.jsx)("span",{className:"font-medium",children:"Ãrea:"})," ",x.size,"mÂ²"]}),(0,r.jsxs)("p",{className:"text-base font-bold text-gray-900 mt-2",children:["R$ ",x.price.toLocaleString("pt-BR")]})]})]})}e.s(["default",()=>s],31886)},47610,e=>{"use strict";var r=e.i(43476),t=e.i(31886),a=e.i(71645);e.i(47167);var s=e.i(81949);let l="http://192.168.18.163:5678/webhook";function o({lot:e,onClose:t,onSuccess:o}){let{formData:n,setFormData:i,isSubmitting:d,error:c,handleSubmit:u}=function(e,r){let t=()=>{let e=localStorage.getItem("currentUser"),r=localStorage.getItem("userData");if(e)try{return JSON.parse(e)}catch(e){console.error("[usePurchaseForm] Erro ao parsear currentUser:",e)}if(r)try{return JSON.parse(r)}catch(e){console.error("[usePurchaseForm] Erro ao parsear userData:",e)}return null},o=t(),[n,i]=(0,a.useState)({customerName:"",customerEmail:"",customerPhone:"",customerCPF:"",message:"",sellerName:o?.name||"",sellerEmail:o?.email||"",sellerPhone:o?.phone||"",sellerCPF:o?.cpf||""});(0,a.useEffect)(()=>{let e=t();e&&(console.log("[usePurchaseForm] âœ… Dados do vendedor carregados automaticamente:",{name:e.name,email:e.email,cpf:e.cpf}),Promise.resolve().then(()=>{i(r=>({...r,sellerName:e.name||r.sellerName,sellerEmail:e.email||r.sellerEmail,sellerPhone:e.phone||r.sellerPhone,sellerCPF:e.cpf||r.sellerCPF}))}))},[]);let[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(null),h=e=>{let r=e.replace(/\D/g,"");if("99999999998"===r)return!0;if(11!==r.length||/^(\d)\1{10}$/.test(r))return!1;let t=0;for(let e=0;e<9;e++)t+=parseInt(r.charAt(e))*(10-e);let a=11-t%11;if(a>=10&&(a=0),a!==parseInt(r.charAt(9)))return!1;t=0;for(let e=0;e<10;e++)t+=parseInt(r.charAt(e))*(11-e);return(a=11-t%11)>=10&&(a=0),a===parseInt(r.charAt(10))},x=async t=>{if(t.preventDefault(),c(!0),m(null),!n.customerCPF||!h(n.customerCPF)){m("CPF do cliente Ã© obrigatÃ³rio e deve ser vÃ¡lido."),c(!1);return}if(!n.sellerCPF||!h(n.sellerCPF)){m("CPF do vendedor Ã© obrigatÃ³rio e deve ser vÃ¡lido."),c(!1);return}try{console.log(`[usePurchaseForm] ðŸ” Verificando disponibilidade do lote ${e.id}...`);let t=await s.default.get(`${l}/mapas/lotes/valido?idLote=${e.id}`);if(0===t.data.isAvailable){m("Este lote nÃ£o estÃ¡ mais disponÃ­vel. Por favor, escolha outro lote."),c(!1),console.log(`[usePurchaseForm] âŒ Lote ${e.id} n\xe3o est\xe1 dispon\xedvel`);return}console.log(`[usePurchaseForm] âœ… Lote ${e.id} est\xe1 dispon\xedvel, prosseguindo com a reserva...`);let a={lot:{id:e.id,mapId:e.mapId,lotNumber:e.lotNumber,area:e.area,status:"reserved",price:e.price,size:e.size,description:e.description,features:e.features,createdAt:e.createdAt,updatedAt:e.updatedAt},customer:{name:n.customerName,email:n.customerEmail,phone:n.customerPhone,cpf:n.customerCPF,message:n.message||null},seller:{name:n.sellerName,email:n.sellerEmail,phone:n.sellerPhone,cpf:n.sellerCPF},purchaseRequest:{lotId:e.id,status:"pending",createdAt:new Date().toISOString()}},o=await s.default.post(`${l}/mapas/lotes/reservar`,a,{headers:{"Content-Type":"application/json"},timeout:1e4});console.log("[usePurchaseForm] âœ… Reserva enviada com sucesso:",o.data),r()}catch(e){console.error("[usePurchaseForm] âŒ Erro ao enviar reserva:",e),s.default.isAxiosError(e)?e.response?409===e.response.status||e.response.data?.message?.includes("disponÃ­vel")?m("Este lote nÃ£o estÃ¡ mais disponÃ­vel. Por favor, escolha outro lote."):m(`Erro do servidor: ${e.response.data?.message||e.response.statusText}`):e.request?m("NÃ£o foi possÃ­vel conectar ao servidor. Verifique sua conexÃ£o."):m("Erro ao preparar requisiÃ§Ã£o."):m("Erro inesperado ao enviar reserva."),c(!1)}};return{formData:n,setFormData:i,isSubmitting:d,error:u,handleSubmit:x}}(e,o),[m,h]=a.default.useState("");return(0,r.jsx)("div",{className:"fixed inset-0 bg-[var(--foreground)]/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-[var(--shadow-xl)] border border-[var(--border)]",children:[(0,r.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-[var(--primary)] to-[var(--primary-light)] text-white p-6 rounded-t-2xl shadow-[var(--shadow-md)] z-10",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-white/15 backdrop-blur-sm rounded-xl flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Manifestar Interesse"}),(0,r.jsxs)("p",{className:"text-white/90 text-sm",children:["Lote ",e.lotNumber]})]})]}),(0,r.jsx)("button",{onClick:t,className:"w-9 h-9 flex items-center justify-center rounded-lg bg-white/10 hover:bg-white/20 transition-colors cursor-pointer",type:"button",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-[var(--primary)]/5 to-[var(--primary-light)]/10 border border-[var(--primary)]/15 rounded-2xl p-5 mb-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"bg-white/80 rounded-xl p-3 border border-[var(--border)]",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-[var(--surface)] mb-1",children:"Ãrea"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-[var(--surface)]",children:[e.size,"mÂ²"]})]}),(0,r.jsxs)("div",{className:"bg-white/80 rounded-xl p-3 border border-[var(--border)]",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-[var(--surface)] mb-1",children:"PreÃ§o"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-[var(--surface)]",children:["R$ ",e.price.toLocaleString("pt-BR")]})]})]}),e.description&&(0,r.jsxs)("div",{className:"bg-white/80 rounded-xl p-3 border border-[var(--border)] mb-4",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-[var(--surface)] mb-2",children:"DescriÃ§Ã£o"}),(0,r.jsx)("p",{className:"text-sm text-[var(--surface)] leading-relaxed",children:e.description})]}),e.features&&e.features.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-[var(--foreground)] mb-2",children:"CaracterÃ­sticas"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:e.features.map((e,t)=>(0,r.jsx)("span",{className:"px-3 py-1.5 bg-white/80 border border-[var(--primary)]/20 text-[var(--primary)] text-xs font-medium rounded-lg",children:e},t))})]})]}),c&&(0,r.jsxs)("div",{className:"bg-[var(--danger)]/10 border border-[var(--danger)]/30 rounded-xl p-4 mb-4 flex items-start gap-3",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-[var(--danger)] flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("p",{className:"text-[var(--danger)] text-sm font-medium",children:c})]}),(0,r.jsxs)("form",{onSubmit:u,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Nome Completo *"}),(0,r.jsx)("input",{type:"text",required:!0,value:n.customerName,onChange:e=>i({...n,customerName:e.target.value}),className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-white focus:ring-2 focus:ring-[var(--primary)]/30 focus:border-[var(--primary)] transition-all",placeholder:"Seu nome completo"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Email *"}),(0,r.jsx)("input",{type:"email",required:!0,value:n.customerEmail,onChange:e=>i({...n,customerEmail:e.target.value}),className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-white focus:ring-2 focus:ring-[var(--primary)]/30 focus:border-[var(--primary)] transition-all",placeholder:"seu@email.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Telefone *"}),(0,r.jsx)("input",{type:"tel",required:!0,value:n.customerPhone,onChange:e=>{let r=e.target.value.replace(/\D/g,""),t=r;t=r.length<=2?r:r.length<=6?`(${r.slice(0,2)}) ${r.slice(2)}`:r.length<=10?`(${r.slice(0,2)}) ${r.slice(2,6)}-${r.slice(6)}`:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7,11)}`,i({...n,customerPhone:t})},className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-white focus:ring-2 focus:ring-[var(--primary)]/30 focus:border-[var(--primary)] transition-all",placeholder:"(00) 00000-0000",maxLength:15})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"CPF *"}),(0,r.jsx)("input",{type:"text",required:!0,value:n.customerCPF,onChange:e=>{let r,t=(r=e.target.value.replace(/\D/g,"")).length<=3?r:r.length<=6?`${r.slice(0,3)}.${r.slice(3)}`:r.length<=9?`${r.slice(0,3)}.${r.slice(3,6)}.${r.slice(6)}`:`${r.slice(0,3)}.${r.slice(3,6)}.${r.slice(6,9)}-${r.slice(9,11)}`;i({...n,customerCPF:t}),14===t.length?(e=>{let r=e.replace(/\D/g,"");if("99999999998"===r)return!0;if(11!==r.length||/^(\d)\1{10}$/.test(r))return!1;let t=0;for(let e=0;e<9;e++)t+=parseInt(r.charAt(e))*(10-e);let a=11-t%11;if(a>=10&&(a=0),a!==parseInt(r.charAt(9)))return!1;t=0;for(let e=0;e<10;e++)t+=parseInt(r.charAt(e))*(11-e);return(a=11-t%11)>=10&&(a=0),a===parseInt(r.charAt(10))})(t)?h(""):h("CPF invÃ¡lido"):h("")},className:`w-full px-4 py-2.5 border rounded-xl text-[var(--foreground)] bg-white focus:ring-2 focus:ring-[var(--primary)]/30 transition-all ${m?"border-red-500 focus:border-red-500":"border-[var(--border)] focus:border-[var(--primary)]"}`,placeholder:"000.000.000-00",maxLength:14}),m&&(0,r.jsxs)("p",{className:"text-red-600 text-sm mt-1",children:["âŒ ",m]})]}),(0,r.jsxs)("div",{className:"border-t border-[var(--border)] pt-4 mt-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-[var(--foreground)]",children:"ðŸ“‹ InformaÃ§Ãµes do Vendedor"}),(n.sellerName||n.sellerEmail||n.sellerCPF)&&(0,r.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium",children:"âœ“ Preenchido automaticamente"})]}),(0,r.jsx)("p",{className:"text-sm text-[var(--foreground)]/70 mb-4",children:n.sellerName||n.sellerEmail||n.sellerCPF?"Seus dados foram carregados automaticamente e nÃ£o podem ser alterados.":"Preencha as informaÃ§Ãµes do vendedor/corretor responsÃ¡vel pela venda"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Nome do Vendedor *"}),(0,r.jsx)("input",{type:"text",required:!0,value:n.sellerName||"",readOnly:!0,disabled:!0,className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-gray-100 cursor-not-allowed",placeholder:"Nome completo do vendedor"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Email do Vendedor *"}),(0,r.jsx)("input",{type:"email",required:!0,value:n.sellerEmail||"",readOnly:!0,disabled:!0,className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-gray-100 cursor-not-allowed",placeholder:"email@vendedor.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Telefone do Vendedor *"}),(0,r.jsx)("input",{type:"tel",required:!0,value:n.sellerPhone||"",readOnly:!0,disabled:!0,className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-gray-100 cursor-not-allowed",placeholder:"(00) 00000-0000",maxLength:15})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"CPF do Vendedor *"}),(0,r.jsx)("input",{type:"text",required:!0,value:n.sellerCPF||"",readOnly:!0,disabled:!0,className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-gray-100 cursor-not-allowed",placeholder:"000.000.000-00",maxLength:14})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-[var(--foreground)] mb-2",children:"Mensagem"}),(0,r.jsx)("textarea",{value:n.message,onChange:e=>i({...n,message:e.target.value}),className:"w-full px-4 py-2.5 border border-[var(--border)] rounded-xl text-[var(--foreground)] bg-white focus:ring-2 focus:ring-[var(--primary)]/30 focus:border-[var(--primary)] transition-all",rows:4,placeholder:"Deixe uma mensagem ou dÃºvida"})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)("button",{type:"submit",disabled:d||""!==m,className:"flex-1 px-5 py-3 bg-[var(--success)] text-white rounded-xl hover:bg-[var(--success)]/90 font-semibold shadow-[var(--shadow-md)] transition-all hover:shadow-[var(--shadow-lg)] disabled:bg-[var(--foreground)]/20 disabled:cursor-not-allowed disabled:hover:shadow-[var(--shadow-md)] cursor-pointer",children:d?(0,r.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):"Enviar Interesse"}),(0,r.jsx)("button",{type:"button",onClick:t,disabled:d,className:"flex-1 px-5 py-3 bg-[var(--surface)] text-[var(--foreground)] border border-[var(--border)] rounded-xl hover:bg-[var(--foreground)]/5 font-semibold shadow-[var(--shadow-sm)] transition-all hover:shadow-[var(--shadow-md)] disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:"Cancelar"})]})]})]})]})})}var n=e.i(73297),i=e.i(18333);let d="http://192.168.18.163:5678/webhook";function c(){let{maps:e,lots:l,selectedMap:c,selectedLot:u,showPurchaseModal:m,isLoading:h,availableLotsCount:x,reservedLotsCount:g,soldLotsCount:p,handleLotClick:f,handlePurchaseSuccess:b,handlePurchaseClose:v,selectMap:y}=(()=>{let[e,r]=(0,a.useState)([]),[t,l]=(0,a.useState)([]),[o,c]=(0,a.useState)(null),u=(0,a.useRef)(null),[m,h]=(0,a.useState)(null),[x,g]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!0),[b,v]=(0,a.useState)(!1),[y,j]=(0,a.useState)(0);(0,i.useRealtimeUpdates)(()=>{console.log("ðŸ”„ Auto-refresh da pÃ¡gina pÃºblica: recarregando mapas e lotes..."),j(e=>e+1)},3e3),(0,a.useEffect)(()=>{(async()=>{try{console.log("ðŸ“ [PÃ¡gina PÃºblica] Buscando mapas da API... (refreshKey:",y,")");let e=(await s.default.get(`${d}/mapas`)).data;if(console.log("âœ… [PÃ¡gina PÃºblica] Resposta da API /mapas:",e),!Array.isArray(e)){console.warn("âš ï¸ [PÃ¡gina PÃºblica] API nÃ£o retornou array de mapas:",e),r([]),l([]),c(null);return}if(e.length>0){let t=e.filter(e=>e&&e.mapId).map(e=>({id:e.mapId,name:e.name||`Mapa ${e.mapId}`,imageUrl:e.imageUrl||"",imageType:e.imageType||"image/png",width:e.width||800,height:e.height||600,createdAt:new Date,updatedAt:new Date}));console.log(`âœ… [P\xe1gina P\xfablica] ${t.length} mapas carregados`),r(t);let a=u.current;if(a&&t.some(e=>e.id===a))console.log(`ðŸ“Œ [P\xe1gina P\xfablica] Mantendo mapa selecionado: ${a}`),await w(a);else if(t.length>0){let e=t[0];console.log(`ðŸŽ¯ [P\xe1gina P\xfablica] Selecionando primeiro mapa: ${e.id} - ${e.name}`),c(e),u.current=e.id,await w(e.id)}}else console.log("ðŸ“­ [PÃ¡gina PÃºblica] Nenhum mapa retornado pela API"),r([]),l([]),c(null),u.current=null}catch(e){console.error("Erro ao buscar mapas:",e),r([]),l([]),c(null)}finally{f(!1)}})()},[y]);let w=async e=>{v(!0);try{console.log(`ðŸ“¦ [P\xe1gina P\xfablica] Buscando lotes do mapa ${e}...`);let r=await s.default.get(`${d}/mapas/lotes`,{params:{mapId:e},timeout:1e4});if(console.log("ðŸ“¦ [PÃ¡gina PÃºblica] Resposta da API /mapas/lotes:",r.data),!r.data){console.warn("âš ï¸ [PÃ¡gina PÃºblica] API retornou resposta vazia para /mapas/lotes"),l([]),v(!1);return}let t=Array.isArray(r.data)?r.data[0]:r.data;if(t&&Array.isArray(t.lots)){let r=t.lots.map(r=>({...r,mapId:t.mapId||e,createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)}));console.log(`âœ… [P\xe1gina P\xfablica] ${r.length} lotes carregados para o mapa ${e}`),l(r)}else console.log("ðŸ“­ [PÃ¡gina PÃºblica] Nenhum lote encontrado para o mapa",e),l([])}catch(e){console.error("âŒ [PÃ¡gina PÃºblica] Erro ao carregar lotes do mapa:",e),l([])}finally{v(!1)}},N=(0,a.useCallback)(e=>{e.status===n.LotStatus.AVAILABLE&&(h(e),g(!0))},[]),P=(0,a.useCallback)(()=>{g(!1),j(e=>e+1),alert("Seu interesse foi registrado com sucesso! O lote foi reservado. Entraremos em contato em breve."),h(null)},[]),k=(0,a.useCallback)(()=>{g(!1),h(null)},[]),C=t.filter(e=>e.status===n.LotStatus.AVAILABLE).length,S=t.filter(e=>e.status===n.LotStatus.RESERVED).length,E=t.filter(e=>e.status===n.LotStatus.SOLD).length,L=(0,a.useCallback)(async r=>{console.log(`Selecionando mapa ${r}...`);let t=e.find(e=>e.id===r);c(t||null),u.current=t?r:null,t?await w(r):l([])},[e]);return{maps:e,lots:t,selectedMap:o,selectedLot:m,showPurchaseModal:x,isLoading:p,isLoadingLots:b,availableLotsCount:C,reservedLotsCount:S,soldLotsCount:E,handleLotClick:N,handlePurchaseSuccess:P,handlePurchaseClose:k,selectMap:L}})();return h?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-[var(--primary)] rounded-full mb-4 animate-pulse shadow-[var(--shadow-lg)]",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,r.jsx)("p",{className:"text-white text-lg font-semibold",children:"Carregando mapas..."})]})})}):(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Mapas e Lotes"}),(0,r.jsx)("p",{className:"text-white/70",children:"Visualize e gerencie os lotes disponÃ­veis para compra"})]}),e.length>1&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-white mb-2",children:"Selecione um Mapa"}),(0,r.jsx)("select",{value:c?.id||"",onChange:e=>y(e.target.value),className:"w-full sm:w-auto px-5 py-3 bg-white border-none rounded-xl text-[#1c1c1c] font-semibold shadow-[var(--shadow-md)] focus:ring-4 focus:ring-[var(--accent)]/30 transition-all cursor-pointer",children:e.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))})]}),c&&(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-3",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-[var(--shadow-lg)] p-4 sm:p-6",children:(0,r.jsx)(t.default,{imageUrl:c.imageUrl,lots:l,onLotClick:f})})}),(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-2xl shadow-[var(--shadow-lg)] p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"EstatÃ­sticas"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-[var(--surface)] rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-[var(--success)] rounded-full shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-white",children:"DisponÃ­vel"})]}),(0,r.jsx)("span",{className:"font-bold text-white text-xl",children:x})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-[var(--surface)] rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-[var(--warning)] rounded-full shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-white",children:"Reservado"})]}),(0,r.jsx)("span",{className:"font-bold text-white text-xl",children:g})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-[var(--surface)] rounded-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-[var(--danger)] rounded-full shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-white",children:"Vendido"})]}),(0,r.jsx)("span",{className:"font-bold text-white text-xl",children:p})]})]})]}),(0,r.jsxs)("div",{className:"bg-[var(--card-bg)] rounded-2xl shadow-[var(--shadow-lg)] p-6",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Legenda"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-[var(--surface-hover)] hover:bg-gradient-to-r hover:from-[var(--success)]/10 hover:to-transparent transition-all border-2 border-transparent hover:border-[var(--success)]/30",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-[var(--success)] rounded shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-[var(--foreground)]",children:"DisponÃ­vel para compra"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-[var(--surface-hover)] hover:bg-gradient-to-r hover:from-[var(--warning)]/10 hover:to-transparent transition-all border-2 border-transparent hover:border-[var(--warning)]/30",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-[var(--warning)] rounded shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-[var(--foreground)]",children:"Reservado"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-[var(--surface-hover)] hover:bg-gradient-to-r hover:from-[var(--danger)]/10 hover:to-transparent transition-all border-2 border-transparent hover:border-[var(--danger)]/30",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-[var(--danger)] rounded shadow-md"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-white",children:"Vendido"})]})]})]})]})]}),0===e.length&&(0,r.jsxs)("div",{className:"text-center py-20",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-[var(--primary)]/20 rounded-full mb-4 shadow-md",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-[var(--primary)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),(0,r.jsx)("p",{className:"text-white text-lg font-semibold",children:"Nenhum mapa disponÃ­vel no momento."})]}),m&&u&&(0,r.jsx)(o,{lot:u,onClose:v,onSuccess:b})]})}e.s(["default",()=>c],47610)}]);