(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83642,e=>{"use strict";var o=e.i(47167),t=e.i(43476),r=e.i(71645),s=e.i(73297),l=e.i(81949);let a=o.default.env.NEXT_PUBLIC_API_URL||"",n=(0,r.createContext)(void 0);function u({children:e}){let[o,u]=(0,r.useState)(()=>{{let e=localStorage.getItem("currentUser");if(e)try{return JSON.parse(e)}catch(e){console.error("[AuthContext] Erro ao recuperar usuÃ¡rio:",e),localStorage.removeItem("currentUser")}}return null});(0,r.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("currentUser"),t=localStorage.getItem("userData");if(!o||e||t||(console.log("[AuthContext] âš ï¸ SessÃ£o perdida - fazendo logout automÃ¡tico"),u(null)),!o&&(e||t))try{let o=JSON.parse(e||t||"");console.log("[AuthContext] ðŸ”„ Restaurando sessÃ£o do localStorage"),u(o)}catch(e){console.error("[AuthContext] Erro ao restaurar sessÃ£o:",e),localStorage.removeItem("currentUser"),localStorage.removeItem("userData")}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[o]);let c=async(e,o)=>{try{console.log("[AuthContext] Tentando login...");let t=e.replace(/\D/g,""),r=await l.default.get(`${a}/usuarios/login?cpf=${t}&password=${encodeURIComponent(o)}`,{headers:{"Content-Type":"application/json"},timeout:1e4});console.log("[AuthContext] âœ… Resposta do login:",r.data);let n=r.data.user||r.data;if(n&&n.id){if(n.status===s.UserStatus.PENDING&&n.role===s.UserRole.VENDEDOR)throw console.log("[AuthContext] âš ï¸ UsuÃ¡rio PENDING"),Error("PENDING");if(n.status===s.UserStatus.REJECTED)throw console.log("[AuthContext] âŒ UsuÃ¡rio REJECTED"),Error("REJECTED");let{password:e,...o}=n;return u(o),localStorage.setItem("currentUser",JSON.stringify(o)),localStorage.setItem("userData",JSON.stringify(o)),console.log("[AuthContext] âœ… Login realizado com sucesso"),console.log("[AuthContext] ðŸ’¾ Dados salvos no localStorage"),!0}return console.log("[AuthContext] âŒ UsuÃ¡rio nÃ£o encontrado"),!1}catch(e){if(e instanceof Error&&("PENDING"===e.message||"REJECTED"===e.message))throw e;if(l.default.isAxiosError(e)&&e.response?.status===401)return console.log("[AuthContext] âŒ Credenciais invÃ¡lidas"),!1;return console.error("[AuthContext] âŒ Erro no login:",e),!1}},i=o?.role===s.UserRole.DEV||o?.role===s.UserRole.ADMIN;return(0,t.jsx)(n.Provider,{value:{user:o,login:c,logout:()=>{u(null),localStorage.removeItem("currentUser"),localStorage.removeItem("userData"),console.log("[AuthContext] ðŸšª Logout realizado - dados removidos do localStorage")},isAuthenticated:!!o,hasRole:e=>!!o&&(o.role===s.UserRole.DEV||o.role===e),canAccessUsers:i},children:e})}function c(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>u,"useAuth",()=>c])}]);