(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56563,e=>{"use strict";let a="lot_platform_maps",t="lot_platform_lots",r="lot_platform_purchases",o=e=>JSON.stringify(e,(e,a)=>a instanceof Date?a.toISOString():a),s=e=>JSON.parse(e,(e,a)=>"string"==typeof a&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(a)?new Date(a):a),l=()=>{let e=localStorage.getItem(a);return e?s(e):[]},i=()=>{let e=localStorage.getItem(t);return e?s(e):[]};e.s(["deleteLot",0,e=>{let a=i().filter(a=>a.id!==e);localStorage.setItem(t,o(a))},"deleteMap",0,e=>{let r=l().filter(a=>a.id!==e);localStorage.setItem(a,o(r));let s=i().filter(a=>a.mapId!==e);localStorage.setItem(t,o(s))},"getLots",0,i,"getLotsByMapId",0,e=>i().filter(a=>a.mapId===e),"getMapById",0,e=>l().find(a=>a.id===e),"getMaps",0,l,"saveLot",0,e=>{let a=i(),r=a.findIndex(a=>a.id===e.id);r>=0?a[r]=e:a.push(e),localStorage.setItem(t,o(a))},"saveMap",0,e=>{let t=l(),r=t.findIndex(a=>a.id===e.id);r>=0?t[r]=e:t.push(e);try{let e=o(t);localStorage.setItem(a,e)}catch(e){if(console.error("Erro ao salvar mapa:",e),e instanceof DOMException&&"QuotaExceededError"===e.name)throw Error("Arquivo muito grande para o localStorage. Use uma imagem menor ou de menor qualidade.");throw e}},"savePurchaseRequest",0,e=>{let a,t=(a=localStorage.getItem(r))?s(a):[];t.push(e),localStorage.setItem(r,o(t))}])},47610,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(56563);let o=e=>(3*(e.length-(e.indexOf(",")+1))/4-("="===e.charAt(e.length-2)?2:+("="===e.charAt(e.length-1))))/1048576;function s(){let[e,s]=(0,t.useState)([]),[l,i]=(0,t.useState)(!1),[n,d]=(0,t.useState)(null);(0,t.useEffect)(()=>{s((0,r.getMaps)())},[]);let m=async e=>{let a=e.target.files?.[0];if(!a)return;let t=new FileReader;t.onload=async e=>{let t=e.target?.result;try{if(a.type.startsWith("image/")){let e=await ((e,a=1920,t=1080,r=.8)=>new Promise((o,s)=>{let l=new Image;l.onload=()=>{let e=document.createElement("canvas"),i=e.getContext("2d");if(!i)return void s(Error("Failed to get canvas context"));let n=l.width,d=l.height;n>a&&(d=d*a/n,n=a),d>t&&(n=n*t/d,d=t),e.width=n,e.height=d,i.drawImage(l,0,0,n,d),o(e.toDataURL("image/jpeg",r))},l.onerror=()=>{s(Error("Failed to load image"))},l.src=e}))(t,1920,1080,.7);if(o(e)>4)return void alert("Imagem muito grande! Por favor, use uma imagem menor ou de menor qualidade.");let l=new Image;l.onload=()=>{try{let t={id:Date.now().toString(),name:n?.name||a.name,description:n?.description||"",imageUrl:e,imageType:"image",width:l.width,height:l.height,createdAt:new Date,updatedAt:new Date};(0,r.saveMap)(t),s((0,r.getMaps)()),i(!1),d(null)}catch(e){console.error("Erro ao salvar mapa:",e),alert(e instanceof Error?e.message:"Erro ao salvar mapa. Tente com uma imagem menor.")}},l.src=e}else if("application/pdf"===a.type){if(o(t)>4)return void alert("PDF muito grande! Por favor, converta para imagem primeiro usando o script convert-pdf.sh ou use uma ferramenta online.");try{let e={id:Date.now().toString(),name:n?.name||a.name,description:n?.description||"",imageUrl:t,imageType:"pdf",width:1920,height:1080,createdAt:new Date,updatedAt:new Date};(0,r.saveMap)(e),s((0,r.getMaps)()),i(!1),d(null)}catch(e){console.error("Erro ao salvar PDF:",e),alert(e instanceof Error?e.message:"Erro ao salvar PDF. Converta para imagem primeiro.")}}}catch(e){console.error("Erro ao processar arquivo:",e),alert("Erro ao processar arquivo. Por favor, tente novamente com um arquivo menor.")}},t.readAsDataURL(a)};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Mapas"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("a",{href:"/admin/data",className:"px-4 py-2 bg-gray-600 text-white font-medium rounded-lg hover:bg-gray-700 shadow-md transition-all hover:shadow-lg",children:"ðŸ“¦ Exportar/Importar"}),(0,a.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 shadow-md transition-all hover:shadow-lg",children:"Novo Mapa"})]})]}),l&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-md shadow-2xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Novo Mapa"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Nome"}),(0,a.jsx)("input",{type:"text",value:n?.name||"",onChange:e=>d({...n,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do mapa"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"DescriÃ§Ã£o"}),(0,a.jsx)("textarea",{value:n?.description||"",onChange:e=>d({...n,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"DescriÃ§Ã£o do mapa",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Upload de Imagem ou PDF"}),(0,a.jsx)("input",{type:"file",accept:"image/*,application/pdf",onChange:m,className:"w-full text-gray-900"}),(0,a.jsxs)("p",{className:"text-xs text-amber-700 mt-2 bg-amber-50 p-2 rounded border border-amber-200",children:["âš ï¸ ",(0,a.jsx)("span",{className:"font-medium",children:"Tamanho mÃ¡ximo recomendado: 4MB."})," A imagem serÃ¡ automaticamente comprimida. Para PDFs grandes, converta para imagem primeiro usando o script convert-pdf.sh"]})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mt-6",children:(0,a.jsx)("button",{onClick:()=>{i(!1),d(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 font-medium rounded-lg hover:bg-gray-300 transition-colors",children:"Cancelar"})})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"h-48 bg-gray-50 flex items-center justify-center overflow-hidden",children:"image"===e.imageType?(0,a.jsx)("img",{src:e.imageUrl,alt:e.name,className:"max-w-full max-h-full object-contain"}):(0,a.jsxs)("div",{className:"text-gray-600 font-medium",children:["PDF: ",e.name]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"DimensÃµes:"})," ",e.width," x ",e.height,"px"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-4 font-mono",children:["ID: ",e.id]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("a",{href:`/admin/lot-management?mapId=${e.id}`,className:"flex-1 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 text-center transition-colors shadow-sm hover:shadow-md",children:"Gerenciar Lotes"}),(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void(confirm("Tem certeza que deseja excluir este mapa e todos os lotes associados?")&&((0,r.deleteMap)(a),s((0,r.getMaps)())))},className:"px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors shadow-sm hover:shadow-md",children:"Excluir"})]})]})]},e.id))}),0===e.length&&!l&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"Nenhum mapa cadastrado. Clique em â€œNovo Mapaâ€ para comeÃ§ar."})})]})}function l(){return(0,a.jsx)(s,{})}e.s(["default",()=>l],47610)}]);