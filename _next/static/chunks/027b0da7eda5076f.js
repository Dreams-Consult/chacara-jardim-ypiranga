(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56563,73297,e=>{"use strict";var a,t=((a={}).AVAILABLE="available",a.RESERVED="reserved",a.SOLD="sold",a);e.s(["LotStatus",()=>t],73297);let r="lot_platform_maps",o="lot_platform_lots",s="lot_platform_purchases",l="lot_platform_initialized",i=e=>JSON.stringify(e,(e,a)=>a instanceof Date?a.toISOString():a),d=e=>JSON.parse(e,(e,a)=>"string"==typeof a&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(a)?new Date(a):a),n=()=>{(()=>{if(localStorage.getItem(l))return;let e={id:"1762192028364",name:"Mapa de Exemplo - ChÃ¡cara Jardim Ypiranga",description:"Mapa de exemplo para testes. Substitua pela imagem real.",imageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iODAwIiBoZWlnaHQ9IjYwMCIgZmlsbD0iI2Y1ZjVmNSIvPjx0ZXh0IHg9IjQwMCIgeT0iMzAwIiBmb250LXNpemU9IjI0IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjOTk5Ij5NYXBhIGRlIEV4ZW1wbG88L3RleHQ+PC9zdmc+",imageType:"image",width:800,height:600,createdAt:new Date("2024-11-03T10:00:00"),updatedAt:new Date("2024-11-03T10:00:00")},a=[{id:"1",mapId:"1762192028364",lotNumber:"1",area:{points:[{x:100,y:100},{x:200,y:100},{x:200,y:200},{x:100,y:200}]},size:250,price:5e4,status:t.AVAILABLE,description:"Lote de exemplo 1",createdAt:new Date("2024-11-03T10:00:00"),updatedAt:new Date("2024-11-03T10:00:00")},{id:"2",mapId:"1762192028364",lotNumber:"2",area:{points:[{x:220,y:100},{x:320,y:100},{x:320,y:200},{x:220,y:200}]},size:250,price:55e3,status:t.AVAILABLE,description:"Lote de exemplo 2",createdAt:new Date("2024-11-03T10:00:00"),updatedAt:new Date("2024-11-03T10:00:00")},{id:"3",mapId:"1762192028364",lotNumber:"3",area:{points:[{x:100,y:220},{x:200,y:220},{x:200,y:320},{x:100,y:320}]},size:250,price:52e3,status:t.RESERVED,description:"Lote de exemplo 3",createdAt:new Date("2024-11-03T10:00:00"),updatedAt:new Date("2024-11-03T10:00:00")}];localStorage.setItem(r,i([e])),localStorage.setItem(o,i(a)),localStorage.setItem(s,i([])),localStorage.setItem(l,"true"),console.log("Dados de exemplo inicializados com sucesso!")})();let e=localStorage.getItem(r);return e?d(e):[]},m=()=>{let e=localStorage.getItem(o);return e?d(e):[]};e.s(["deleteLot",0,e=>{let a=m().filter(a=>a.id!==e);localStorage.setItem(o,i(a))},"deleteMap",0,e=>{let a=n().filter(a=>a.id!==e);localStorage.setItem(r,i(a));let t=m().filter(a=>a.mapId!==e);localStorage.setItem(o,i(t))},"getLots",0,m,"getLotsByMapId",0,e=>m().filter(a=>a.mapId===e),"getMapById",0,e=>n().find(a=>a.id===e),"getMaps",0,n,"saveLot",0,e=>{let a=m(),t=a.findIndex(a=>a.id===e.id);t>=0?a[t]=e:a.push(e),localStorage.setItem(o,i(a))},"saveMap",0,e=>{let a=n(),t=a.findIndex(a=>a.id===e.id);t>=0?a[t]=e:a.push(e);try{let e=i(a);localStorage.setItem(r,e)}catch(e){if(console.error("Erro ao salvar mapa:",e),e instanceof DOMException&&"QuotaExceededError"===e.name)throw Error("Arquivo muito grande para o localStorage. Use uma imagem menor ou de menor qualidade.");throw e}},"savePurchaseRequest",0,e=>{let a,t=(a=localStorage.getItem(s))?d(a):[];t.push(e),localStorage.setItem(s,i(t))}],56563)},47610,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(56563);let o=e=>(3*(e.length-(e.indexOf(",")+1))/4-("="===e.charAt(e.length-2)?2:+("="===e.charAt(e.length-1))))/1048576;function s(){let[e,s]=(0,t.useState)([]),[l,i]=(0,t.useState)(!1),[d,n]=(0,t.useState)(null);(0,t.useEffect)(()=>{s((0,r.getMaps)())},[]);let m=async e=>{let a=e.target.files?.[0];if(!a)return;let t=new FileReader;t.onload=async e=>{let t=e.target?.result;try{if(a.type.startsWith("image/")){let e=await ((e,a=1920,t=1080,r=.8)=>new Promise((o,s)=>{let l=new Image;l.onload=()=>{let e=document.createElement("canvas"),i=e.getContext("2d");if(!i)return void s(Error("Failed to get canvas context"));let d=l.width,n=l.height;d>a&&(n=n*a/d,d=a),n>t&&(d=d*t/n,n=t),e.width=d,e.height=n,i.drawImage(l,0,0,d,n),o(e.toDataURL("image/jpeg",r))},l.onerror=()=>{s(Error("Failed to load image"))},l.src=e}))(t,1920,1080,.7);if(o(e)>4)return void alert("Imagem muito grande! Por favor, use uma imagem menor ou de menor qualidade.");let l=new Image;l.onload=()=>{try{let t={id:Date.now().toString(),name:d?.name||a.name,description:d?.description||"",imageUrl:e,imageType:"image",width:l.width,height:l.height,createdAt:new Date,updatedAt:new Date};(0,r.saveMap)(t),s((0,r.getMaps)()),i(!1),n(null)}catch(e){console.error("Erro ao salvar mapa:",e),alert(e instanceof Error?e.message:"Erro ao salvar mapa. Tente com uma imagem menor.")}},l.src=e}else if("application/pdf"===a.type){if(o(t)>4)return void alert("PDF muito grande! Por favor, converta para imagem primeiro usando o script convert-pdf.sh ou use uma ferramenta online.");try{let e={id:Date.now().toString(),name:d?.name||a.name,description:d?.description||"",imageUrl:t,imageType:"pdf",width:1920,height:1080,createdAt:new Date,updatedAt:new Date};(0,r.saveMap)(e),s((0,r.getMaps)()),i(!1),n(null)}catch(e){console.error("Erro ao salvar PDF:",e),alert(e instanceof Error?e.message:"Erro ao salvar PDF. Converta para imagem primeiro.")}}}catch(e){console.error("Erro ao processar arquivo:",e),alert("Erro ao processar arquivo. Por favor, tente novamente com um arquivo menor.")}},t.readAsDataURL(a)};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Mapas"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("a",{href:"/admin/data",className:"px-4 py-2 bg-gray-600 text-white font-medium rounded-lg hover:bg-gray-700 shadow-md transition-all hover:shadow-lg",children:"ðŸ“¦ Exportar/Importar"}),(0,a.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 shadow-md transition-all hover:shadow-lg",children:"Novo Mapa"})]})]}),l&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-md shadow-2xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Novo Mapa"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Nome"}),(0,a.jsx)("input",{type:"text",value:d?.name||"",onChange:e=>n({...d,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do mapa"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"DescriÃ§Ã£o"}),(0,a.jsx)("textarea",{value:d?.description||"",onChange:e=>n({...d,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"DescriÃ§Ã£o do mapa",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Upload de Imagem ou PDF"}),(0,a.jsx)("input",{type:"file",accept:"image/*,application/pdf",onChange:m,className:"w-full text-gray-900"}),(0,a.jsxs)("p",{className:"text-xs text-amber-700 mt-2 bg-amber-50 p-2 rounded border border-amber-200",children:["âš ï¸ ",(0,a.jsx)("span",{className:"font-medium",children:"Tamanho mÃ¡ximo recomendado: 4MB."})," A imagem serÃ¡ automaticamente comprimida. Para PDFs grandes, converta para imagem primeiro usando o script convert-pdf.sh"]})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mt-6",children:(0,a.jsx)("button",{onClick:()=>{i(!1),n(null)},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 font-medium rounded-lg hover:bg-gray-300 transition-colors",children:"Cancelar"})})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"h-48 bg-gray-50 flex items-center justify-center overflow-hidden",children:"image"===e.imageType?(0,a.jsx)("img",{src:e.imageUrl,alt:e.name,className:"max-w-full max-h-full object-contain"}):(0,a.jsxs)("div",{className:"text-gray-600 font-medium",children:["PDF: ",e.name]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-2",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"DimensÃµes:"})," ",e.width," x ",e.height,"px"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-4 font-mono",children:["ID: ",e.id]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("a",{href:`/admin/lot-management?mapId=${e.id}`,className:"flex-1 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 text-center transition-colors shadow-sm hover:shadow-md",children:"Gerenciar Lotes"}),(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void(confirm("Tem certeza que deseja excluir este mapa e todos os lotes associados?")&&((0,r.deleteMap)(a),s((0,r.getMaps)())))},className:"px-4 py-2 bg-red-600 text-white font-medium rounded-lg hover:bg-red-700 transition-colors shadow-sm hover:shadow-md",children:"Excluir"})]})]})]},e.id))}),0===e.length&&!l&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600 text-lg",children:"Nenhum mapa cadastrado. Clique em â€œNovo Mapaâ€ para comeÃ§ar."})})]})}function l(){return(0,a.jsx)(s,{})}e.s(["default",()=>l],47610)}]);